##### Небольшой дисклеймер. Код писался двумя джунами, без ревью. Многое подлежит рефакторингу
